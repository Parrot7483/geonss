#!/bin/sh
#
# Pre-commit hook that runs pytest before allowing a commit
# 
# To install: cp hooks/pre-commit .git/hooks/pre-commit && chmod +x .git/hooks/pre-commit
#

echo "Running pytest before commit..."

# Ensure we're in the repository root
cd "$(git rev-parse --show-toplevel)"

# Run pytest with the configuration from pyproject.toml
python -m pytest

# Check the exit status of pytest
if [ $? -ne 0 ]; then
    echo "❌ Tests failed! Commit aborted."
    echo "Please fix the failing tests before committing."
    exit 1
fi

echo "✅ All tests passed! Proceeding with commit."
exit 0
